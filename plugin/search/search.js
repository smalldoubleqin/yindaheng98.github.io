var themeLocalSearch=function({search_path:t,zip_Path:e,version_Path:n,input_Trigger:o,top_N:r}){var s=!1;0===t.length?t="search.xml":/json$/i.test(t);var a=function(t){$(".popup").fadeOut(300),$("body").removeClass("body-fixed"),$("#local-search-input").val(""),$(".search-result-list").remove(),$("#no-result").remove(),$(".search-result-number").remove()};function i(){$(".popup").fadeIn(300),$("body").addClass("body-fixed");var t=$("#local-search-input");t.attr("autocapitalize","none"),t.attr("autocorrect","off"),t.focus()}$.get(n+"?t="+ +new Date,function(n){localStorage.getItem("searchVersion")!==n&&(localStorage.setItem("searchVersion",n),initLoad([e],{loadOptions:{success:function(e){localStorage.setItem("searchJson",e[t])},error:function(t){return console.log(t)}},returnOptions:{json:TYPE_TEXT},mimeOptions:{json:"application/json"}}))});var l,c=function(t,e){"use strict";s=!0;var n=JSON.parse(localStorage.getItem("searchJson"));console.log(t);var a=document.getElementById(t),l=document.getElementById(e),c=function(){$(".local-search-popup").animate({scrollTop:0},5);var t=a.value.trim().toLowerCase(),e=t.split(/[\s\-]+/);e.length>1&&e.push(t);var o=[];if(t.length>0&&n.forEach(function(n){var s=!1,a=0,i=0,l=n.title?n.title.trim():"",c=l.toLowerCase(),u=n.content?n.content.trim().replace(/<[^>]+>/g,""):"",h=u.toLowerCase(),p=decodeURIComponent(n.url),g=[],f=[];if(e.forEach(function(t){function e(t,e,n){var o=t.length;if(0===o)return[];var r=0,s=[],a=[];for(n||(e=e.toLowerCase(),t=t.toLowerCase());(s=e.indexOf(t,r))>-1;)a.push({position:s,word:t}),r=s+o;return a}g=g.concat(e(t,c,!1)),f=f.concat(e(t,h,!1))}),(g.length>0||f.length>0)&&(s=!0,a=g.length+f.length),s){function d(e,n,o,r){for(var s=r[r.length-1],a=s.position,l=s.word,c=[],u=0;a+l.length<=o&&0!=r.length;){l===t&&u++,c.push({position:a,length:l.length});var h=a+l.length;for(r.pop();0!=r.length&&(a=(s=r[r.length-1]).position,l=s.word,h>a);)r.pop()}return i+=u,{hits:c,start:n,end:o,searchTextCount:u}}[g,f].forEach(function(t){t.sort(function(t,e){return e.position!==t.position?e.position-t.position:t.word.length-e.word.length})});var v=[];0!=g.length&&v.push(d(0,0,l.length,g));for(var m=[];0!=f.length;){var C=f[f.length-1],$=C.position,T=C.word,x=$-20,b=$+80;x<0&&(x=0),b<$+T.length&&(b=$+T.length),b>u.length&&(b=u.length),m.push(d(0,x,b,f))}m.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hits.length!==e.hits.length?e.hits.length-t.hits.length:t.start-e.start});var w=parseInt(r);function E(t,e){var n="",o=e.start;return e.hits.forEach(function(e){n+=t.substring(o,e.position);var r=e.position+e.length;n+='<b class="search-keyword">'+t.substring(e.position,r)+"</b>",o=r}),n+=t.substring(o,e.end)}w>=0&&(m=m.slice(0,w));var L="";0!=v.length?L+="<li><a target='_blank' href='"+p+"' class='search-result-title'>"+E(l,v[0])+"</a>":L+="<li><a target='_blank' href='"+p+"' class='search-result-title'>"+l+"</a>",m.forEach(function(t){L+="<a target='_blank' href='"+p+'\'><p class="search-result-content">'+E(u,t)+"...</p></a>"}),L+="</li>",o.push({item:L,searchTextCount:i,hitCount:a,id:o.length})}}),1===e.length&&""===e[0])l.innerHTML='<div id="no-result"><i class="fa fa-search fa-2x" /></div>';else if(0===o.length)l.innerHTML='<div id="no-result"><i class="fa fa-frown-o fa-3x" /></div>';else{o.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hitCount!==e.hitCount?e.hitCount-t.hitCount:e.id-t.id});var s='<div class="search-result-number">'+o.length+' results at total!</div><ul class="search-result-list">';o.forEach(function(t){s+=t.item}),s+="</ul>",l.innerHTML=s}};"auto"===o?a.addEventListener("input",c):a.addEventListener("keypress",function(t){13===t.keyCode&&c()}),i()};$(".popup-trigger").click(function(t){t.stopPropagation(),!1===s?($(".sb-close").click(),c("local-search-input","local-search-output")):i()}),$(".popup-btn-close").click(a),$(".popup").click(function(t){t.stopPropagation()}),$(document).on("keyup",function(t){27===t.which&&$(".search-popup").is(":visible")&&a()}),l=$(".input-prompt").outerHeight(),$(".local-search-popup").scroll(function(){$(".local-search-popup").scrollTop()>=l/2?$("#local-search-input").addClass("input-fixed"):$("#local-search-input").removeClass("input-fixed")}).trigger("scroll")};