<!DOCTYPE html><html class="html-loading"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>nodejsä¸­çš„Promiseå¯¹è±¡ | Howard-Blogs</title><meta name="author" content="Howard Yin"><meta name="keywords" content><meta name="description" content><link rel="shortcut icon" href="/img/favicon.ico"><link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><link rel="stylesheet" href="/css/Annie.css"><script src="/js/jquery.min.js"></script><script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script><script src="/js/leancloud.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/katex.min.css"></head><body><div id="preloader"><div class="pre-container"><div class="spinner"><div class="double-bounce1"></div><div class="double-bounce2"></div></div></div></div><header class="fixbackground" data-img-mode="normal" data-normal-src="/img/1.jpg" data-random-max="110" data-random-src="https://sariay.github.io/Random-img/"><div class="mask"><div class="h-header"><div id="logo"><a href="/"><img src="/img/logo.png" alt="Logo"></a></div><div id="navigation-show"><ul><li class="menu-home"><a href="/" class="menu-item-home">ä¸»é¡µ</a></li><li class="menu-archive"><a href="/archives" class="menu-item-archive">å½’æ¡£</a></li><li class="menu-categories"><a href="/categories" class="menu-item-categories">åˆ†ç±»</a></li><li class="menu-tags"><a href="/tags" class="menu-item-tags">æ ‡ç­¾</a></li><li class="menu-about"><a href="/about" class="menu-item-about">å…³äº</a></li><li class="menu-gallery"><a href="/gallery" class="menu-item-gallery">ç›¸å†Œ</a></li></ul></div></div><div class="h-body"><p class="motto"></p></div><div class="h-footer"><a href="javascript:;" id="read-more"><i class="fa fa-angle-double-down" aria-hidden="true"></i></a><style type="text/css">.header-date{font-size:1.6rem;color:#fff;position:absolute;bottom:5px;right:1rem;writing-mode:tb-rl}.header-date a{border-bottom:none}@media only screen and (max-width:768){.header-date{font-size:1rem}}</style><div class="header-date"><a href="https://time.is/Beijing" id="time_is_link" rel="nofollow"></a> <span id="Beijing_z43d"></span></div><script src="//widget.time.is/zh.js"></script><script>time_is_widget.init({Beijing_z43d:{template:"DATE",date_format:"yearå¹´ monthnumæœˆ dnumæ—¥"}})</script></div></div></header><div id="navigation-hide"><div id="progress-bar"></div><div id="progress-percentage"><h1>0.0%</h1></div><div class="toc-switch"><span class="switch-button">ç›®å½•</span></div><p>å½“å‰æ–‡ç« &nbsp;:&nbsp;ã€Šnodejsä¸­çš„Promiseå¯¹è±¡ã€‹</p><a class="nav-trigger"><span></span></a></div><nav class="nav-container" id="cd-nav"><div class="nav-header"><h3>Navigation</h3><a href="javascript:;" class="nav-close"></a></div><div class="nav-body"><ul><li class="menu-home"><a href="/" class="menu-item-home">ä¸»é¡µ</a></li><li class="menu-archive"><a href="/archives" class="menu-item-archive">å½’æ¡£</a></li><li class="menu-categories"><a href="/categories" class="menu-item-categories">åˆ†ç±»</a></li><li class="menu-tags"><a href="/tags" class="menu-item-tags">æ ‡ç­¾</a></li><li class="menu-about"><a href="/about" class="menu-item-about">å…³äº</a></li><li class="menu-gallery"><a href="/gallery" class="menu-item-gallery">ç›¸å†Œ</a></li></ul></div><div class="nav-footer"><ul><li><a href="http://github.com/yindaheng98" target="_blank"><i class="fa fa-github"></i></a></li><li><a href="http://github.com/yindaheng98" target="_blank"><i class="fa fa-weibo"></i></a></li><li><a href="http://github.com/yindaheng98" target="_blank"><i class="fa fa-pinterest"></i></a></li><li><a href="http://github.com/yindaheng98" target="_blank"><i class="fa fa-instagram"></i></a></li><li><a href="http://github.com/yindaheng98" target="_blank"><i class="fa fa-twitter"></i></a></li><li><a href="/atom.xml" target="_blank"><i class="fa fa-rss"></i></a></li></ul></div></nav><main><div class="layout-toc"><div id="layout-toc"><div class="k-catelog-list" id="catelog-list" data-title="æ–‡ç« ç›®å½•"></div></div></div><script src="/plugin/toc/katelog.min.js"></script><div class="layout-post"><div id="layout-post"><div class="article-title"><i class="fa fa-paper-plane-o" aria-hidden="true"></i> <a href="/ç¼–ç¨‹è¯­è¨€/Node/nodejs-promise.html" itemprop="url">nodejsä¸­çš„Promiseå¯¹è±¡</a></div><div class="article-meta"><span><i class="fa fa-calendar"></i> å‘å¸ƒäº <a href="/ç¼–ç¨‹è¯­è¨€/Node/nodejs-promise.html" itemprop="url"><time datetime="2019-12-09T12:10:32.000Z" itemprop="datePublished">2019-12-09 </time></a>&nbsp; æ›´æ–°äº <a href="/ç¼–ç¨‹è¯­è¨€/Node/nodejs-promise.html" itemprop="url"><time datetime="2019-12-09T12:10:32.000Z" itemprop="dateUpdated">2020-06-24</time></a> </span><span><i class="fa fa-tags"></i> <a href="/tags/Node/">Node</a></span></div><div class="article-content" id="article-content"><p><code>Promise</code>æ˜¯ä¸€ç§æœ‰ä¸‰ä¸ªçŠ¶æ€çš„å¯¹è±¡ï¼ˆâ€œæ‰§è¡Œä¸­<code>pending</code>â€ã€â€œå®Œæˆ<code>resolve</code>â€ã€â€œå¤±è´¥<code>reject</code>â€ï¼‰ï¼Œæ„é€ <code>Promise</code>å¯¹è±¡æ—¶çš„æ„é€ å‡½æ•°å‚æ•°æ˜¯ä¸€ä¸ªæœ‰ä¸¤ä¸ªå‚æ•°çš„å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°çš„ä¸¤ä¸ªå‚æ•°åˆ†åˆ«å¯¹åº”ç€<code>Promise</code>å¯¹è±¡åˆ°è¾¾ä¸¤ä¸ªç»ˆç‚¹çŠ¶æ€<code>resolve</code>æˆ–<code>reject</code>æ—¶è¦è°ƒç”¨çš„å‡½æ•°ã€‚</p><p>ä¸€ä¸ªå…¸å‹çš„<code>Promise</code>æ„é€ å¦‚ä¸‹ğŸ‘‡</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>)</span>&#123;</span><br><span class="line">    <span class="comment">/*æ‰§è¡Œå„ç±»è¯­å¥a*/</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="comment">/*æŸä¸ªè¡¨ç¤ºä»»åŠ¡å®Œæˆçš„åˆ¤æ–­æ¡ä»¶*/</span>)</span><br><span class="line">        resolve(<span class="comment">/*ä¸Šé¢çš„è¯­å¥ä¸­äº§ç”Ÿçš„æŸä¸ªå˜é‡*/</span>)</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        reject(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="comment">/*æŸä¸ªé”™è¯¯*/</span>))</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>ğŸ‘†å½“ä¸Šé¢è¿™ä¸ªæ–°å»º<code>Promise</code>è¯­å¥æ‰§è¡Œæ—¶ï¼Œ<code>Promise</code>æ„é€ å‡½æ•°ä¸­çš„<code>function(resolve, reject){}</code>ä¼šç«‹å³è¢«æ‰§è¡Œï¼Œå½“è¿™ä¸ªå‡½æ•°åœ¨æ‰§è¡Œâ€œ<code>/*æ‰§è¡Œå„ç±»è¯­å¥a*/</code>â€æ—¶ï¼Œ<code>Promise</code>å¯¹è±¡çš„çŠ¶æ€ä¸ºâ€œ<code>pending</code>â€ï¼›å¦‚æœåˆ¤æ–­æ¡ä»¶ä½¿å‡½æ•°æ‰§è¡Œåˆ°äº†<code>resolve</code>å‡½æ•°ï¼Œåˆ™<code>Promise</code>å¯¹è±¡çŠ¶æ€å˜ä¸º<code>resolve</code>ï¼›å¦‚æœåˆ¤æ–­æ¡ä»¶ä½¿å‡½æ•°æ‰§è¡Œåˆ°äº†<code>reject</code>å‡½æ•°ï¼Œåˆ™<code>Promise</code>å¯¹è±¡çŠ¶æ€å˜ä¸º<code>reject</code>ã€‚</p><p>ä¸ºäº†è®©<code>Promise</code>åœ¨æˆ‘ä»¬æƒ³è¦çš„åœ°æ–¹æ‰§è¡Œï¼Œä¸€èˆ¬æŠŠ<code>Promise</code>åŠ ä¸ªå£³å†™æˆè¿™æ ·ğŸ‘‡</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> myPromise = <span class="function"><span class="keyword">function</span> (<span class="params">some_value</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">        <span class="comment">/*æ‰§è¡Œå„ç±»è¯­å¥ï¼Œç”¨åˆ°some_value*/</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="comment">/*æŸä¸ªè¡¨ç¤ºä»»åŠ¡å®Œæˆçš„åˆ¤æ–­æ¡ä»¶*/</span>)</span><br><span class="line">            resolve(<span class="comment">/*ä¸Šé¢çš„è¯­å¥ä¸­äº§ç”Ÿçš„æŸä¸ªå˜é‡v*/</span>)</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            reject(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="comment">/*æŸä¸ªé”™è¯¯e*/</span>))</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è°ƒç”¨<code>myPromise()</code>çš„è¿”å›å€¼ä¸ºä¸€ä¸ªæ–°å»ºçš„<code>Promise</code>å¯¹è±¡ã€‚</p><p>ç„¶åç”¨çš„æ—¶å€™å°±è¿™ä¹ˆå†™ğŸ‘‡</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">myPromise(some_value)</span><br></pre></td></tr></table></figure><p>å…³äº<code>return</code>çš„æ³¨æ„äº‹é¡¹ğŸ‘‡</p><h2 id="resolveå’Œrejectå‡½æ•°ä»ä½•è€Œæ¥"><a class="markdownIt-Anchor" href="#resolveå’Œrejectå‡½æ•°ä»ä½•è€Œæ¥"></a> resolveå’Œrejectå‡½æ•°ä»ä½•è€Œæ¥ï¼Ÿ</h2><h3 id="ç­”æ›°æ¥è‡ªthenæ–¹æ³•æˆ–è€…catchfinalæ–¹æ³•"><a class="markdownIt-Anchor" href="#ç­”æ›°æ¥è‡ªthenæ–¹æ³•æˆ–è€…catchfinalæ–¹æ³•"></a> ç­”æ›°ï¼šæ¥è‡ª<code>then</code>æ–¹æ³•æˆ–è€…<code>catch/final</code>æ–¹æ³•ã€‚</h3><p>åœ¨ä¸Šé¢çš„<code>Promise</code>ä¾‹å­ä¸­ï¼Œå¦‚ä½•å‘Šè¯‰<code>myPromise</code>resolveå’Œrejectéƒ½æ˜¯ä»€ä¹ˆå‡½æ•°ï¼Ÿ</p><h4 id="æ­£ç¡®å§¿åŠ¿1"><a class="markdownIt-Anchor" href="#æ­£ç¡®å§¿åŠ¿1"></a> æ­£ç¡®å§¿åŠ¿1ğŸ‘‡</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">resolve</span>(<span class="params">v<span class="regexp">/*å¯¹åº”ä¸Šé¢ä¾‹å­ä¸­çš„å˜é‡v*/</span></span>)</span>&#123;<span class="comment">/*å¯¹våšç‚¹ä»€ä¹ˆ*/</span>&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">reject</span>(<span class="params">e<span class="regexp">/*å¯¹åº”ä¸Šé¢ä¾‹å­ä¸­çš„é”™è¯¯e*/</span></span>)</span>&#123;<span class="comment">/*å¯¹eåšç‚¹ä»€ä¹ˆ*/</span>&#125;</span><br><span class="line">myPromise(some_value).then(resolve,reject)</span><br></pre></td></tr></table></figure><p>ğŸ‘†è¿™æ ·resolveå’Œrejectå°±ä¼šåœ¨æ„é€ myPromiseçš„é‚£ä¸ªå‡½æ•°é‡Œé¢è¢«æ‰§è¡Œäº†ã€‚è¿™å°±ç›¸å½“äº<code>myPromise</code>æ‰§è¡Œå®Œæˆä¹‹åæŠŠæŸä¸ªç»“æœ<code>v</code>ä¼ é€’ç»™äº†<code>resolve</code>å‡½æ•°ã€‚ç„¶åè¿™ä¸ª<code>then</code>çš„è¿”å›å€¼å°±æ˜¯é‚£ä¸ª<code>function (resolve, reject) {}</code>çš„è¿”å›å€¼ã€‚</p><h4 id="æ­£ç¡®å§¿åŠ¿2"><a class="markdownIt-Anchor" href="#æ­£ç¡®å§¿åŠ¿2"></a> æ­£ç¡®å§¿åŠ¿2ğŸ‘‡</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">resolve</span>(<span class="params">v<span class="regexp">/*å¯¹åº”ä¸Šé¢ä¾‹å­ä¸­çš„å˜é‡v*/</span></span>)</span>&#123;<span class="comment">/*å¯¹våšç‚¹ä»€ä¹ˆ*/</span>&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">reject</span>(<span class="params">e<span class="regexp">/*å¯¹åº”ä¸Šé¢ä¾‹å­ä¸­çš„é”™è¯¯e*/</span></span>)</span>&#123;<span class="comment">/*å¯¹eåšç‚¹ä»€ä¹ˆ*/</span>&#125;</span><br><span class="line">myPromise(some_value).then(resolve).catch(reject)</span><br></pre></td></tr></table></figure><p>ğŸ‘†èµ·å§‹<code>then</code>é‡Œé¢å¯ä»¥ä¸ç”¨å†™<code>reject</code>ç”¨çš„é‚£ä¸ªå‡½æ•°ï¼Œ<code>reject</code>å‡½æ•°å¯ä»¥å†™åœ¨<code>.catch</code>æ–¹æ³•é‡Œé¢ï¼Œå°±åƒ<code>try{}catch(){}</code>é”™è¯¯å¤„ç†ä¸€æ ·ï¼Œå¦‚æœåˆ äº†ä¸Šé¢é‚£ä¸ª<code>.catch(reject)</code>ï¼Œå½“å‡ºé”™æ—¶<code>new Error(/*æŸä¸ªé”™è¯¯e*/)</code>ä¼šçœŸçš„ä½œä¸ºé”™è¯¯è¢«æŠ›å‡ºæ¥ã€‚</p><p><code>myPromise(some_value)</code>çš„è¿”å›å€¼æ˜¯ä¸€ä¸ª<code>Promise</code>å¯¹è±¡ï¼Œè€Œ<code>myPromise(some_value).then(resolve,reject)</code>çš„è¿”å›å€¼åˆ™æ˜¯myPromiseå¯¹è±¡æ„é€ æ—¶é‡Œé¢é‚£ä¸ª<code>function (resolve, reject) {}</code>çš„è¿”å›å€¼ã€‚</p><p>åœ¨ä¸Šé¢è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>myPromise(some_value).then(resolve,reject)</code>å’Œ<code>myPromise(some_value).then(resolve).catch(reject)</code>çš„è¿”å›å€¼éƒ½ä¸º<code>undefined</code>å› ä¸º<code>myPromise</code>é‡Œé¢çš„<code>function (resolve, reject) {}</code>æ²¡æœ‰è¿”å›å€¼ã€‚</p><blockquote><p>æ³¨æ„ï¼Œè°ƒç”¨resolveæˆ–rejectå¹¶ä¸ä¼šç»ˆç»“ Promise çš„å‚æ•°å‡½æ•°çš„æ‰§è¡Œã€‚</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  resolve(<span class="number">1</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">2</span>);</span><br><span class="line">&#125;).then(<span class="function"><span class="params">r</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(r);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// 2</span></span><br><span class="line"><span class="comment">// 1</span></span><br></pre></td></tr></table></figure><blockquote><p>ä¸Šé¢ä»£ç ä¸­ï¼Œè°ƒç”¨<code>resolve(1)</code>ä»¥åï¼Œåé¢çš„<code>console.log(2)</code>è¿˜æ˜¯ä¼šæ‰§è¡Œï¼Œå¹¶ä¸”ä¼šé¦–å…ˆæ‰“å°å‡ºæ¥ã€‚è¿™æ˜¯å› ä¸ºè™½ç„¶çœ‹èµ·æ¥<code>resolve(1)</code>åœ¨<code>console.log(2)</code>çš„å‰é¢ï¼Œä½†æ˜¯è¿™å…¶å®åªæ˜¯å‘Šè¯‰äº†<code>Promise</code>å½“<code>resolve</code>æ—¶è¦æ‰§è¡Œ<code>resolve(1)</code>ï¼Œè¿™ä¸ª<code>resolve(1)</code>è¯­å¥ä¼šè¢«ä¿ç•™ç›´åˆ°<code>console.log(2)</code>æ‰§è¡Œå®Œå¹¶ä¸”å‡½æ•°é€€å‡ºåæ‰ä¼šè§¦å‘ã€‚</p><p>ä¸€èˆ¬æ¥è¯´ï¼Œè°ƒç”¨<code>resolve</code>æˆ–<code>reject</code>ä»¥åï¼Œ<code>Promise</code>çš„ä½¿å‘½å°±å®Œæˆäº†ï¼Œåç»§æ“ä½œåº”è¯¥æ”¾åˆ°<code>then</code>æ–¹æ³•é‡Œé¢ï¼Œè€Œä¸åº”è¯¥ç›´æ¥å†™åœ¨<code>resolve</code>æˆ–<code>reject</code>çš„åé¢ã€‚æ‰€ä»¥ï¼Œæœ€å¥½åœ¨å®ƒä»¬å‰é¢åŠ ä¸Š<code>return</code>è¯­å¥ï¼Œè¿™æ ·å°±ä¸ä¼šæœ‰æ„å¤–ã€‚</p></blockquote><p>å°±åƒè¿™æ ·ğŸ‘‡</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> myPromise = <span class="function"><span class="keyword">function</span> (<span class="params">some_value</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">        <span class="comment">/*æ‰§è¡Œå„ç±»è¯­å¥ï¼Œç”¨åˆ°some_value*/</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="comment">/*æŸä¸ªè¡¨ç¤ºä»»åŠ¡å®Œæˆçš„åˆ¤æ–­æ¡ä»¶*/</span>)</span><br><span class="line">            <span class="keyword">return</span> resolve(<span class="comment">/*ä¸Šé¢çš„è¯­å¥ä¸­äº§ç”Ÿçš„æŸä¸ªå˜é‡v*/</span>)</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span> reject(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="comment">/*æŸä¸ªé”™è¯¯e*/</span>))</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ—¶å†è°ƒç”¨<code>myPromise(some_value).then(resolve,reject)</code>å’Œ<code>myPromise(some_value).then(resolve).catch(reject)</code>çš„è¯å°±ä¼šæœ‰è¿”å›å€¼äº†ï¼Œå› ä¸º<code>myPromise</code>é‡Œé¢çš„<code>function (resolve, reject) {}</code>æœ‰äº†è¿”å›å€¼ã€‚å¹¶ä¸”æŒ‰ç…§ä¸Šé¢é‚£ä¸ªå†™æ³•ï¼Œ<code>myPromise(some_value).then(resolve,reject)</code>å’Œ<code>myPromise(some_value).then(resolve).catch(reject)</code>çš„è¿”å›å€¼å°±æ˜¯<code>resolve(/*ä¸Šé¢çš„è¯­å¥ä¸­äº§ç”Ÿçš„æŸä¸ªå˜é‡v*/)</code>æˆ–è€…<code>reject(new Error(/*æŸä¸ªé”™è¯¯e*/))</code></p><p>åé¢æ‰€æœ‰çš„ä»£ç éƒ½é»˜è®¤<code>Promise</code>åœ¨<code>resolve</code>æˆ–<code>reject</code>å¤„è¿”å›å€¼ã€‚</p><h2 id="nodejsé«˜ç©çš„éªšæ“ä½œ"><a class="markdownIt-Anchor" href="#nodejsé«˜ç©çš„éªšæ“ä½œ"></a> nodejsé«˜ç©çš„éªšæ“ä½œğŸ‘‡</h2><h3 id="resolveå‡½æ•°è¿”å›ä¸€ä¸ªpromise"><a class="markdownIt-Anchor" href="#resolveå‡½æ•°è¿”å›ä¸€ä¸ªpromise"></a> <code>resolve</code>å‡½æ•°è¿”å›ä¸€ä¸ª<code>Promise</code></h3><p>å…ˆæ¥ä¸ªç®€å•çš„ï¼Œè®©<code>then</code>è¿”å›ä¸€ä¸ªæ–°çš„<code>myPromise</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> myPromise = <span class="function"><span class="keyword">function</span> (<span class="params">some_value</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">        <span class="comment">/*æ‰§è¡Œå„ç±»è¯­å¥ï¼Œç”¨åˆ°some_value*/</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="comment">/*æŸä¸ªè¡¨ç¤ºä»»åŠ¡å®Œæˆçš„åˆ¤æ–­æ¡ä»¶*/</span>)</span><br><span class="line">            <span class="keyword">return</span> resolve(v<span class="comment">/*ä¸Šé¢çš„è¯­å¥ä¸­äº§ç”Ÿçš„æŸä¸ªå˜é‡v*/</span>)</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span> reject(<span class="keyword">new</span> <span class="built_in">Error</span>(e<span class="comment">/*æŸä¸ªé”™è¯¯e*/</span>))</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">myPromise(value1).then(<span class="function"><span class="keyword">function</span>(<span class="params">v</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> myPromise(v)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>ç„¶åå› ä¸ºç¬¬ä¸€ä¸ª<code>then</code>çš„è¿”å›å€¼å˜æˆä¸€ä¸ª<code>Promise</code>äº†ï¼Œå®ƒåˆå¯ä»¥å†<code>then</code>ä¸€æ¬¡ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥è¿›ä¸€æ­¥è¿™ä¹ˆå†™ğŸ‘‡</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">resolve</span>(<span class="params">v<span class="regexp">/*å¯¹åº”ä¸Šé¢ä¾‹å­ä¸­çš„å˜é‡v*/</span></span>)</span>&#123;<span class="comment">/*å¯¹våšç‚¹ä»€ä¹ˆ*/</span>&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">reject</span>(<span class="params">e<span class="regexp">/*å¯¹åº”ä¸Šé¢ä¾‹å­ä¸­çš„é”™è¯¯e*/</span></span>)</span>&#123;<span class="comment">/*å¯¹eåšç‚¹ä»€ä¹ˆ*/</span>&#125;</span><br><span class="line"></span><br><span class="line">myPromise(value1).then(<span class="function"><span class="keyword">function</span>(<span class="params">v</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> myPromise(v)</span><br><span class="line">&#125;).then(resolve,reject)</span><br></pre></td></tr></table></figure><p>æˆ–è€…è¿™ä¹ˆå†™ğŸ‘‡</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">myPromise(value1).then(<span class="function"><span class="keyword">function</span>(<span class="params">v</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> myPromise(v)</span><br><span class="line">&#125;).then(resolve).catch(reject)</span><br></pre></td></tr></table></figure><p>è¿™ç›¸å½“äºæ˜¯æŠŠ<code>myPromise(value1)</code>çš„ç»“æœä¼ é€’ç»™äº†åˆä¸€ä¸ª<code>myPromise(v)</code>ï¼Œç„¶åå†æŠŠ<code>myPromise(v)</code>çš„ç»“æœä¼ é€’ç»™<code>resolve(v)</code>ï¼›å¹¶ä¸”<code>myPromise(v)</code>åœ¨<code>myPromise(value1)</code>åˆ°<code>resolve</code>çŠ¶æ€äº†ä¹‹åæ‰ä¼šæ‰§è¡Œã€‚</p><h4 id="å‡ºé”™äº†å’‹åŠ"><a class="markdownIt-Anchor" href="#å‡ºé”™äº†å’‹åŠ"></a> å‡ºé”™äº†å’‹åŠï¼Ÿ</h4><p>æ³¨æ„åˆ°ä¸Šé¢ä¸¤ä¸ªä¾‹å­ä¸­çš„ç¬¬ä¸€ä¸ª<code>then</code>æ²¡æœ‰æŒ‡å®š<code>reject</code>ï¼Œè¿™æ—¶å¦‚æœæœ‰æŸä¸€ä¸ª<code>myPromise</code>è¿è¡Œåˆ°<code>reject</code>äº†ï¼Œåé¢çš„<code>then</code>éƒ½ä¸ä¼šæ‰§è¡Œç›´åˆ°è¿™ä¸ª<code>reject</code>ç¢°åˆ°äº†æŸä¸ª<code>then(resolve,reject)</code>æˆ–è€…<code>catch(reject)</code>ã€‚å¦‚æœåé¢æ²¡æœ‰<code>then(resolve,reject)</code>æˆ–è€…<code>catch(reject)</code>äº†ï¼Ÿé‚£å°±æˆä¸ºä¸€ä¸ªè¢«æŠ›å‡ºçš„é”™è¯¯ã€‚</p><h4 id="éªšæ“ä½œx5"><a class="markdownIt-Anchor" href="#éªšæ“ä½œx5"></a> éªšæ“ä½œx5</h4><p>è¿6ä¸ª<code>myPromise</code>ğŸ‘‡</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">myPromise(v1).then(<span class="function"><span class="keyword">function</span>(<span class="params">v2</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> myPromise(v2)</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params">v3</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> myPromise(v3)</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params">v4</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> myPromise(v4)</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params">v5</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> myPromise(v5)</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params">v6</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> myPromise(v6)</span><br><span class="line">&#125;).then(resolve).catch(reject)</span><br></pre></td></tr></table></figure><p>å¥—4ä¸ª<code>myPromise</code>ğŸ‘‡</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">myPromise(v1).then(<span class="function"><span class="keyword">function</span>(<span class="params">v2</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> myPromise(v2).then(<span class="function"><span class="keyword">function</span>(<span class="params">v3</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> myPromise2(v2,v3).then(<span class="function"><span class="keyword">function</span>(<span class="params">v4</span>)</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> myPromise3(v2,v3,v4)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;).then(resolve).catch(reject)</span><br></pre></td></tr></table></figure><p>åµŒå¥—å’Œè¿æ¥ä¸ä¸€æ ·çš„åœ°æ–¹å°±åœ¨äºï¼ŒåµŒå¥—å¯ä»¥ç»¼åˆå‰é¢å„ä¸ª<code>Promise</code>çš„è¿”å›å€¼ï¼Œè¿æ¥åªèƒ½è·å–å‰é¢ä¸€ä¸ªã€‚<code>myPromise2</code>å’Œ<code>myPromise3</code>å®šä¹‰å¦‚ä¸‹ğŸ‘‡ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> myPromise2 = <span class="function"><span class="keyword">function</span> (<span class="params">v2,v3</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">        <span class="comment">/*æ‰§è¡Œå„ç±»è¯­å¥*/</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="comment">/*æŸä¸ªè¡¨ç¤ºä»»åŠ¡å®Œæˆçš„åˆ¤æ–­æ¡ä»¶*/</span>)</span><br><span class="line">            <span class="keyword">return</span> resolve(v4<span class="comment">/*ä¸Šé¢çš„è¯­å¥ä¸­äº§ç”Ÿçš„æŸä¸ªå˜é‡v4*/</span>)</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span> reject(<span class="keyword">new</span> <span class="built_in">Error</span>(e<span class="comment">/*æŸä¸ªé”™è¯¯e*/</span>))</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> myPromise2 = <span class="function"><span class="keyword">function</span> (<span class="params">v2,v3,v4</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">        <span class="comment">/*æ‰§è¡Œå„ç±»è¯­å¥*/</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="comment">/*æŸä¸ªè¡¨ç¤ºä»»åŠ¡å®Œæˆçš„åˆ¤æ–­æ¡ä»¶*/</span>)</span><br><span class="line">            <span class="keyword">return</span> resolve(v5<span class="comment">/*ä¸Šé¢çš„è¯­å¥ä¸­äº§ç”Ÿçš„æŸä¸ªå˜é‡v5*/</span>)</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span> reject(<span class="keyword">new</span> <span class="built_in">Error</span>(e<span class="comment">/*æŸä¸ªé”™è¯¯e*/</span>))</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="asyncawait"><a class="markdownIt-Anchor" href="#asyncawait"></a> async/await</h2><p><a href="https://segmentfault.com/a/1190000007535316" target="_blank" rel="noopener">æ•™ç¨‹å‚è€ƒ</a></p><p><img src="i/nodejs_4.png" alt="async/await"></p><p>éšç€ Node 7 çš„å‘å¸ƒï¼Œè¶Šæ¥è¶Šå¤šçš„äººå¼€å§‹ç ”ç©¶æ®è¯´æ˜¯å¼‚æ­¥ç¼–ç¨‹ç»ˆçº§è§£å†³æ–¹æ¡ˆçš„ async/awaitã€‚async æ˜¯â€œå¼‚æ­¥â€çš„ç®€å†™ï¼Œè€Œ await å¯ä»¥è®¤ä¸ºæ˜¯ async wait çš„ç®€å†™ã€‚æ‰€ä»¥åº”è¯¥å¾ˆå¥½ç†è§£ <strong>async ç”¨äºç”³æ˜ä¸€ä¸ª function æ˜¯å¼‚æ­¥çš„</strong>ï¼Œè€Œ <strong>await ç”¨äºç­‰å¾…ä¸€ä¸ªå¼‚æ­¥æ–¹æ³•æ‰§è¡Œå®Œæˆ</strong>ã€‚</p><p>å¦‚æœéœ€è¦é€šè¿‡ await æ¥è°ƒç”¨ä¸€ä¸ª async å‡½æ•°ï¼Œé‚£è¿™ä¸ªè°ƒç”¨çš„å¤–é¢å¿…é¡»å¾—å†åŒ…ä¸€ä¸ª async å‡½æ•°ï¼Œç„¶åâ€¦â€¦è¿›å…¥æ­»å¾ªç¯ï¼Œæ°¸æ— å‡ºå¤´ä¹‹æ—¥â€¦â€¦</p><h3 id="async"><a class="markdownIt-Anchor" href="#async"></a> async</h3><p>ä¸€ä¸ªå•ç‹¬çš„asyncæœ‰ä»€ä¹ˆç”¨ï¼Ÿè¯·çœ‹ğŸ‘‡</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">testAsync</span>(<span class="params">i</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(i)<span class="keyword">return</span> <span class="string">"hello async"</span> + i;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"Oops!"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> result = testAsync(<span class="number">1</span>);</span><br><span class="line"><span class="built_in">console</span>.log(result);</span><br><span class="line"><span class="keyword">const</span> another = testAsync();</span><br></pre></td></tr></table></figure><p>è¾“å‡ºğŸ‘‡</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Promise &#123; <span class="string">'hello async'</span> &#125;</span><br></pre></td></tr></table></figure><p>å’Œä¸€ä¸ªé”™è¯¯ğŸ‘‡</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UnhandledPromiseRejectionWarning: Error: Oops!</span><br></pre></td></tr></table></figure><p>çœ‹åˆ°è¾“å‡ºå°±æç„¶å¤§æ‚Ÿäº†â€”â€” è¾“å‡ºçš„æ˜¯ä¸€ä¸ª Promise å¯¹è±¡ã€‚</p><p>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ç†è§£äº†ï¼ŒasyncæŠŠä¸€ä¸ªå‡½æ•°å˜æˆäº†Promiseï¼Œå¹¶å°†<code>return</code>çš„å†…å®¹æ”¾åˆ°äº†<code>resolve</code>ä¸­ï¼Œ<code>throw</code>çš„å†…å®¹æ”¾åˆ°äº†<code>reject</code>ä¸­ï¼Œå®ƒå°±æ˜¯ä¸€ç§æ›´åŠ æ–¹ä¾¿è€Œç›´è§‚åœ°å®šä¹‰<code>Promise</code>çš„æ–¹æ³•ã€‚å› æ­¤ï¼Œä¸Šé¢è¿™ä¸ªå‡½æ•°å°±åº”è¯¥è¿™æ ·ç”¨ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">testAsync(<span class="number">1</span>).then(<span class="function">(<span class="params">r</span>)=&gt;</span>&#123;<span class="built_in">console</span>.log(r)&#125;).catch(<span class="function">(<span class="params">e</span>)=&gt;</span>&#123;<span class="built_in">console</span>.log(e)&#125;);</span><br><span class="line">testAsync().then(<span class="function">(<span class="params">r</span>)=&gt;</span>&#123;<span class="built_in">console</span>.log(r)&#125;).catch(<span class="function">(<span class="params">e</span>)=&gt;</span>&#123;<span class="built_in">console</span>.log(e)&#125;);</span><br></pre></td></tr></table></figure><h3 id="await"><a class="markdownIt-Anchor" href="#await"></a> await</h3><p>awaitçš„ä½¿ç”¨åˆ†ä¸¤ç§æƒ…å†µï¼Œç¬¬ä¸€ç§æ˜¯awaitçš„è¡¨è¾¾å¼ä¸æ˜¯<code>Promise</code>æ—¶ï¼Œè¿™æ—¶æœ‰æ²¡æœ‰awaitéƒ½ä¸€æ ·ã€‚æ¯”å¦‚ä¸‹é¢è¿™æ®µä»£ç è¾“å‡º3ğŸ‘‡</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params">i</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> res = <span class="keyword">await</span> i + <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">console</span>.log(res);</span><br><span class="line">&#125;;</span><br><span class="line">test(<span class="number">2</span>);</span><br></pre></td></tr></table></figure><p>è€Œç¬¬äºŒç§æ˜¯awaitçš„è¡¨è¾¾å¼æ˜¯<code>Promise</code>çš„æ—¶å€™ï¼Œè¿™æ—¶å®ƒä¼šæŠŠ<code>Promise</code>ä¸­<code>resolve</code>çš„è¾“å…¥ä½œä¸ºç»“æœè¿”å›ï¼Œè€Œå°†<code>reject</code>çš„è¾“å…¥ä½œä¸ºé”™è¯¯æŠ›å‡ºã€‚æ¯”å¦‚ä¸Šä¸€èŠ‚ç”¨thené“¾è°ƒç”¨çš„<code>async</code>å‡½æ•°çš„ä»£ç ç­‰æ•ˆäºğŸ‘‡</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> r = <span class="keyword">await</span> testAsync(<span class="number">1</span>);</span><br><span class="line">        <span class="built_in">console</span>.log(r);</span><br><span class="line">        <span class="keyword">await</span> testAsync();</span><br><span class="line">    &#125; <span class="keyword">catch</span>(e) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(e)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">test();</span><br></pre></td></tr></table></figure><p>ä»ä¸Šé¢å¯ä»¥çœ‹å‡ºï¼ŒåŠ äº†awaitçš„<code>Promise</code>å°±åƒä¸€ä¸ªæ™®é€šçš„å‡½æ•°ä¸€æ ·ï¼Œç«‹å³è¿”å›äº†ä»–çš„å¤„ç†ç»“æœï¼Œawaitå¯ä»¥çœ‹ä½œæ˜¯ä¸€ç§è°ƒç”¨<code>Promise</code>çš„ç®€ä¾¿æ–¹æ³•ã€‚ä½†æ˜¯æˆ‘ä»¬çŸ¥é“ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œ<code>resolve</code>åœ¨<code>Promise</code>ä¸­æ˜¯å¼‚æ­¥è°ƒç”¨çš„ï¼Œå³å®ƒä¸ä¼šç«‹å³è¿”å›ï¼Œé‚£awaitæ˜¯æ€ä¹ˆå®ç°æŠŠä¸€ä¸ª<code>Promise</code>çš„<code>resolve</code>ç«‹å³è¿”å›çš„å‘¢ï¼Ÿå¾ˆç®€å•ï¼Œå®ƒé˜»å¡äº†åé¢çš„ä»£ç ç›´åˆ°<code>resolve</code>è¿”å›ã€‚è¿™ç›¸å½“äºæŠŠawaitåé¢çš„ä»£ç å…¨éƒ¨æ”¾åˆ°<code>then</code>é“¾å®šä¹‰çš„<code>resolve</code>é‡Œé¢äº†ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸Šé¢çš„ä»£ç ç­‰æ•ˆäºğŸ‘‡</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve,reject</span>) =&gt;</span> &#123;</span><br><span class="line">        testAsync(<span class="number">1</span>).then(<span class="function">(<span class="params">r</span>)=&gt;</span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(r);</span><br><span class="line">            <span class="keyword">return</span> testAsync().then(<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">                resolve()</span><br><span class="line">                &#125;);</span><br><span class="line">        &#125;).catch(<span class="function">(<span class="params">e</span>)=&gt;</span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"catched!"</span>)</span><br><span class="line">            <span class="built_in">console</span>.log(e)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line">test();</span><br></pre></td></tr></table></figure><p>æ¯”èµ·<code>async/await</code>ä»£ç ï¼Œ<code>Promise</code>ä»£ç éš¾åº¦ä¸å°‘ï¼Œä¸æ˜¯å—ï¼Ÿ</p><p>å…³äº<code>try/catch</code>çš„ä½ç½®ï¼Œæ­¤å¤„æœ‰ä¸€ä¸ªæ˜“é”™ç‚¹ï¼Œæ¯”å¦‚åƒè¿™æ ·æŠŠ<code>try/catch</code>æ”¾åˆ°å¤–é¢æ¥çš„åšæ³•æ˜¯æ•æ‰ä¸åˆ°æˆ‘ä»¬æƒ³è¦çš„é”™è¯¯çš„ğŸ‘‡</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> r = <span class="keyword">await</span> testAsync(<span class="number">1</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(r);</span><br><span class="line">    <span class="keyword">await</span> testAsync();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    test();</span><br><span class="line">&#125; <span class="keyword">catch</span>(e) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"catched!"</span>)</span><br><span class="line">    <span class="built_in">console</span>.log(e)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸ºä»€ä¹ˆæ•æ‰ä¸åˆ°ä¹Ÿå¾ˆå¥½ç†è§£ï¼Œå› ä¸ºå‰é¢æ ‡äº†<code>async</code>çš„å‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ª<code>Promise</code>ï¼Œå®ƒçš„é”™è¯¯è¦åœ¨<code>.catch((e)=&gt;{})</code>é‡Œé¢æˆ–è€…ç”¨<code>await</code>æ‰èƒ½æ•æ‰åˆ°ï¼Œå°±åƒè¿™æ ·ğŸ‘‡</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">test().catch(<span class="function">(<span class="params">e</span>)=&gt;</span>&#123;<span class="built_in">console</span>.log(<span class="string">"catched!"</span>);<span class="built_in">console</span>.log(e)&#125;)</span><br></pre></td></tr></table></figure><p>è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªæ³¨æ„ç‚¹ï¼Œé‚£å°±æ˜¯å¼‚æ­¥ä»£ç æ˜¯ä¸èƒ½å‘åŒæ­¥ä»£ç æŠ›å‡ºé”™è¯¯çš„ï¼Œæ¯”å¦‚ä¸Šé¢é‚£æ®µè¿›å…¥åˆ°<code>catch</code>ä¸­çš„é”™è¯¯ä¸èƒ½å†æŠ›å‡ºåˆ°å¤–å±‚çš„åŒæ­¥ä»£ç ä¸­ï¼Œæ¯”å¦‚è¿™æ®µä»£ç ä¹Ÿæ˜¯ä¸èƒ½æ­£ç¡®æ•æ‰åˆ°é”™è¯¯çš„ğŸ‘‡</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">    test().catch(<span class="function">(<span class="params">e</span>)=&gt;</span>&#123;<span class="keyword">throw</span> e&#125;)</span><br><span class="line">&#125; <span class="keyword">catch</span>(e) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"catched!"</span>)</span><br><span class="line">    <span class="built_in">console</span>.log(e)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å³ä½¿ç”¨äº‹ä»¶è§¦å‘ä¹Ÿæ˜¯ä¸€æ ·ä¸èƒ½æ•æ‰çš„</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> events = <span class="built_in">require</span>(<span class="string">"events"</span>)</span><br><span class="line"><span class="keyword">let</span> emitter = <span class="keyword">new</span> events.EventEmitter()</span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">    emitter.on(<span class="string">"error"</span>,(e)=&gt;&#123;<span class="keyword">throw</span> e&#125;)</span><br><span class="line">&#125; <span class="keyword">catch</span>(e) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"catched!"</span>)</span><br><span class="line">    <span class="built_in">console</span>.log(e)</span><br><span class="line">&#125;</span><br><span class="line">test().catch(<span class="function">(<span class="params">e</span>)=&gt;</span>&#123;emitter.emit(<span class="string">"error"</span>,e)&#125;)</span><br></pre></td></tr></table></figure><p>å¼‚æ­¥ä»£ç çš„é”™è¯¯åªèƒ½ç”¨å¼‚æ­¥ä»£ç æ•æ‰åˆ°ã€‚</p></div><div id="current-post-cover" data-scr="/ç¼–ç¨‹è¯­è¨€/Node/i/nodejs_4.png"></div><div class="investment-container"><div class="investment-header"><div class="investment-title-1"><div class="on">ç›¸å…³æ–‡ç« </div><div>è¯„è®º</div><div>åˆ†äº«</div></div><div class="investment-title-2"><span><a href="javascript: window.scrollTo(0, 0);">è¿”å›é¡¶éƒ¨</a> <a href="/Docker/Docker-proxy.html" title="Docker ä»£ç†æ€»ç»“" rel="prev">&laquo;ä¸Šä¸€ç¯‡ </a><a href="/ç¼–ç¨‹è¯­è¨€/Node/nodejs-feature.html" title="nodejsé‡è¦ç‰¹æ€§" rel="next">ä¸‹ä¸€ç¯‡&raquo;</a></span></div></div><div class="investment-content"><div class="investment-content-list"><div class="relate-post"><ul><li><div class="relate-post-text"><a class="relate-post-title" href="/ç¼–ç¨‹è¯­è¨€/Tex/Texå†å².html" title="TEXå†å²">TEXå†å²</a><p class="relate-post-date"><i class="fa fa-calendar"></i> å…­æœˆ 24æ—¥, 2020</p><p class="relate-post-content">å‚è€ƒèµ„æ–™å‚è€ƒèµ„æ–™ èµ·æºKnuth æœ€æ—©æ˜¯åœ¨ä¸€å° DEC PDP-11 ä¸Šç”¨ä¸€ç§å«åš SAIL çš„è¯­è¨€ç¼–å†™çš„ TeXï¼Œå°”åä»–å’Œä¸€äº›åˆä½œè€…ï¼Œå¼€å§‹åœ¨ Stanford å¤§å­¦å®éªŒä¸€ç§å«åš literate programming (æ–‡å­¦ç¼–ç¨‹)...</p></div><div class="relate-post-cover"><a href="/ç¼–ç¨‹è¯­è¨€/Tex/Texå†å².html" title="TEXå†å²"><img class="lazy" src="/img/placeholder.jpg" data-src="/img/cart_cover.jpg" alt="TEXå†å²"></a></div></li><li><div class="relate-post-text"><a class="relate-post-title" href="/ç¼–ç¨‹è¯­è¨€/Go/goçš„åå°„.html" title="(æœªå®Œæˆ)goçš„åå°„">(æœªå®Œæˆ)goçš„åå°„</a><p class="relate-post-date"><i class="fa fa-calendar"></i> å››æœˆ 7æ—¥, 2020</p><p class="relate-post-content">goçš„åå°„æ¨¡å‹åœ¨Golangå®ç°çš„åå°„ä¸­ï¼Œinterface{}å˜é‡å¯ä»¥çœ‹ä½œä¸€ä¸ªâ€œpairâ€ï¼Œâ€œpairâ€ä¸­è®°å½•äº†å®é™…å˜é‡çš„å€¼å’Œç±»å‹ï¼š(value, type)ï¼Œvalueè®°å½•äº†å˜é‡çš„å€¼ï¼Œtypeè®°å½•äº†å˜é‡çš„ç±»å‹ã€‚è¿™ä¸ªâ€œpairâ€åœ¨...</p></div><div class="relate-post-cover"><a href="/ç¼–ç¨‹è¯­è¨€/Go/goçš„åå°„.html" title="(æœªå®Œæˆ)goçš„åå°„"><img class="lazy" src="/img/placeholder.jpg" data-src="/img/cart_cover.jpg" alt="(æœªå®Œæˆ)goçš„åå°„"></a></div></li><li><div class="relate-post-text"><a class="relate-post-title" href="/ç¼–ç¨‹è¯­è¨€/Tex/LaTeXåŸºç¡€.html" title="LaTeXåŸºç¡€">LaTeXåŸºç¡€</a><p class="relate-post-date"><i class="fa fa-calendar"></i> å››æœˆ 2æ—¥, 2020</p><p class="relate-post-content">å‚è€ƒèµ„æ–™ï¼šLaTeX vs. MiKTeX: The levels of TeXdoc ã€ltxdoc ä¸ docstrip The levels of TeX â€”â€” TeXç³»ç»Ÿçš„å±‚æ¬¡ç»“æ„å‘è¡Œç‰ˆï¼šTeX Liveã€MiKTeXã€CTe...</p></div><div class="relate-post-cover"><a href="/ç¼–ç¨‹è¯­è¨€/Tex/LaTeXåŸºç¡€.html" title="LaTeXåŸºç¡€"><img class="lazy" src="/img/placeholder.jpg" data-src="/img/cart_cover.jpg" alt="LaTeXåŸºç¡€"></a></div></li><li><div class="relate-post-text"><a class="relate-post-title" href="/ç¼–ç¨‹è¯­è¨€/Tex/æ–‡å­¦ç¼–ç¨‹.html" title="æ–‡å­¦ç¼–ç¨‹ï¼ˆLiterate Programmingï¼‰">æ–‡å­¦ç¼–ç¨‹ï¼ˆLiterate Programmingï¼‰</a><p class="relate-post-date"><i class="fa fa-calendar"></i> å››æœˆ 1æ—¥, 2020</p><p class="relate-post-content">æ­£å¦‚ Donald Ervin Knuth æ‰€æ„æƒ³çš„é‚£æ ·ï¼Œæ–‡å­¦ç¼–ç¨‹èŒƒå‹ä¸åŒäºä¼ ç»Ÿçš„ç”±è®¡ç®—æœºå¼ºåŠ çš„ç¼–å†™ç¨‹åºçš„æ–¹å¼å’Œé¡ºåºï¼Œè€Œä»£ä¹‹ä»¥è®©ç¨‹åºå‘˜ç”¨ä»–ä»¬è‡ªå·±æ€ç»´å†…åœ¨çš„é€»è¾‘å’Œæµç¨‹æ‰€è¦æ±‚çš„é¡ºåºå¼€å‘ç¨‹åºã€‚â€”â€”ç»´åŸºç™¾ç§‘graph LR foo.w...</p></div><div class="relate-post-cover"><a href="/ç¼–ç¨‹è¯­è¨€/Tex/æ–‡å­¦ç¼–ç¨‹.html" title="æ–‡å­¦ç¼–ç¨‹ï¼ˆLiterate Programmingï¼‰"><img class="lazy" src="/img/placeholder.jpg" data-src="/img/cart_cover.jpg" alt="æ–‡å­¦ç¼–ç¨‹ï¼ˆLiterate Programmingï¼‰"></a></div></li><li><div class="relate-post-text"><a class="relate-post-title" href="/ç¼–ç¨‹è¯­è¨€/Tex/TeXåŸºç¡€.html" title="TEXåŸºç¡€">TEXåŸºç¡€</a><p class="relate-post-date"><i class="fa fa-calendar"></i> å››æœˆ 1æ—¥, 2020</p><p class="relate-post-content">TEXå‘½ä»¤è¡Œçš„ä½¿ç”¨é¦–å…ˆï¼Œç¬¬ä¸€æ­¥å½“ç„¶æ˜¯æ‰“å¼€TEXå‘½ä»¤è¡Œï¼Œå¦‚æœå®‰è£…äº†TEXï¼š1$ texç„¶åä¼šæ˜¾ç¤ºï¼š12This is TeX, Version 3.14159265 (TeX Live 2019/W32TeX) (preloaded ...</p></div><div class="relate-post-cover"><a href="/ç¼–ç¨‹è¯­è¨€/Tex/TeXåŸºç¡€.html" title="TEXåŸºç¡€"><img class="lazy" src="/img/placeholder.jpg" data-src="/ç¼–ç¨‹è¯­è¨€/Tex/i/TeXif1.png" alt="TEXåŸºç¡€"></a></div></li><li><div class="relate-post-text"><a class="relate-post-title" href="/ç¼–ç¨‹è¯­è¨€/Tex/TeXå…¬å¼Tips.html" title="TEXå…¬å¼çŸ¥è¯†ç‚¹æ‹¾é—">TEXå…¬å¼çŸ¥è¯†ç‚¹æ‹¾é—</a><p class="relate-post-date"><i class="fa fa-calendar"></i> å››æœˆ 1æ—¥, 2020</p><p class="relate-post-content">\leftå’Œ\rightTEX æœ‰ä¸€ä¸ªå†…ç½®çš„æœºåˆ¶, èƒ½ç¡®å®šè¦å°è£…ä½ç»™å®šå…¬å¼æ‰€éœ€è¦çš„è¿™å¯¹åˆ†ç•Œç¬¦çš„é«˜åº¦; å› æ­¤, ä½ å¯ä»¥ä½¿ç”¨è¿™ ç§æ–¹æ³•, è€Œä¸ç”¨è‡ªå·±åœ¨\bigï¼Œ\biggæˆ–å…¶å®ƒä¸­ç­›é€‰ã€‚æ‰€è¦åšçš„åªæ˜¯ï¼š1\left&lt;delim1&gt...</p></div><div class="relate-post-cover"><a href="/ç¼–ç¨‹è¯­è¨€/Tex/TeXå…¬å¼Tips.html" title="TEXå…¬å¼çŸ¥è¯†ç‚¹æ‹¾é—"><img class="lazy" src="/img/placeholder.jpg" data-src="/img/cart_cover.jpg" alt="TEXå…¬å¼çŸ¥è¯†ç‚¹æ‹¾é—"></a></div></li><li><div class="relate-post-text"><a class="relate-post-title" href="/ç¼–ç¨‹è¯­è¨€/Node/nodejs-feature.html" title="nodejsé‡è¦ç‰¹æ€§">nodejsé‡è¦ç‰¹æ€§</a><p class="relate-post-date"><i class="fa fa-calendar"></i> åäºŒæœˆ 6æ—¥, 2019</p><p class="relate-post-content">å›è°ƒå‡½æ•°å¦‚æœçœ‹è§æŸä¸ªå‡½æ•°å®šä¹‰é•¿ä¸‹é¢è¿™æ ·ğŸ‘‡é‚£å®ƒå°±åº”è¯¥æ˜¯ä¸ªå¸¦å›è°ƒçš„å‡½æ•°ã€‚è¿™ç±»çš„å‡½æ•°ä¸€èˆ¬ä¸ºjså†…ç½®ï¼Œåœ¨è°ƒç”¨çš„æ—¶å€™éƒ½æ˜¯ä½œä¸ºä¸€ä¸ªæ–°çº¿ç¨‹è¿è¡Œçš„ã€‚1function some_function(param1,param2,callback)&#...</p></div><div class="relate-post-cover"><a href="/ç¼–ç¨‹è¯­è¨€/Node/nodejs-feature.html" title="nodejsé‡è¦ç‰¹æ€§"><img class="lazy" src="/img/placeholder.jpg" data-src="/ç¼–ç¨‹è¯­è¨€/Node/i/nodejs_1.jpg" alt="nodejsé‡è¦ç‰¹æ€§"></a></div></li><li><div class="relate-post-text"><a class="relate-post-title" href="/ç¼–ç¨‹è¯­è¨€/Shell/Shell-tips.html" title="Shellæ‹¾é—">Shellæ‹¾é—</a><p class="relate-post-date"><i class="fa fa-calendar"></i> åäºŒæœˆ 3æ—¥, 2019</p><p class="relate-post-content">getoptså’Œgetoptè¿™ä¸¤ä¸ªéƒ½æ˜¯ç”¨æ¥è§£æè„šæœ¬è¿è¡Œæ—¶çš„å‘½ä»¤è¡Œå‚æ•°çš„ã€‚ getoptsåªèƒ½å¤„ç†çŸ­é€‰é¡¹ï¼Œæ— æ³•å¤„ç†é•¿é€‰é¡¹ï¼Œæš‚ä¸ä»‹ç» getoptå¯ä»¥åŒæ—¶å¤„ç†çŸ­é€‰é¡¹å’Œé•¿é€‰é¡¹ã€‚getoptå‘½ä»¤ä¸æ˜¯ä¸€ä¸ªæ ‡å‡†çš„unixå‘½ä»¤ï¼Œä½†å®ƒåœ¨å¤§å¤šæ•°Lin...</p></div><div class="relate-post-cover"><a href="/ç¼–ç¨‹è¯­è¨€/Shell/Shell-tips.html" title="Shellæ‹¾é—"><img class="lazy" src="/img/placeholder.jpg" data-src="/img/cart_cover.jpg" alt="Shellæ‹¾é—"></a></div></li><li><div class="relate-post-text"><a class="relate-post-title" href="/ç¼–ç¨‹è¯­è¨€/Node/nodejs-tips.html" title="nodejsè¡¥å……çŸ¥è¯†">nodejsè¡¥å……çŸ¥è¯†</a><p class="relate-post-date"><i class="fa fa-calendar"></i> åä¸€æœˆ 29æ—¥, 2019</p><p class="relate-post-content">åœ¨æŒ‡å®šç›®å½•ä¸‹è¿è¡Œnpm éœ€æ±‚æ¥æºå†™äº†ä¸€ä¸ªéœ€è¦åœ¨æœ¬åœ°ä¿å­˜æ–‡ä»¶çš„é¡¹ç›®ï¼Œæƒ³è®©è¿™ä¸ªé¡¹ç›®èƒ½åœ¨ä»»æ„ä½ç½®ä¿å­˜æ–‡ä»¶ï¼Œä½†æ˜¯åˆä¸æƒ³å•ç‹¬ä¸ºè¿™ä¸€ä¸ªåŠŸèƒ½å•ç‹¬æé…ç½®æ–‡ä»¶ï¼Œäºæ˜¯ä¹åœ¨ä»£ç é‡Œé¢ç”¨process.CWD()æŒ‡å®šæ–‡ä»¶è·¯å¾„ï¼Œä½¿ä¿å­˜ç›®å½•ä¸ºç¨‹åºå®é™…è¿è¡Œçš„ç›®å½•ã€‚...</p></div><div class="relate-post-cover"><a href="/ç¼–ç¨‹è¯­è¨€/Node/nodejs-tips.html" title="nodejsè¡¥å……çŸ¥è¯†"><img class="lazy" src="/img/placeholder.jpg" data-src="/img/cart_cover.jpg" alt="nodejsè¡¥å……çŸ¥è¯†"></a></div></li><li><div class="relate-post-text"><a class="relate-post-title" href="/ç¼–ç¨‹è¯­è¨€/Java/SpringåŸç†.html" title="SpringåŸç†">SpringåŸç†</a><p class="relate-post-date"><i class="fa fa-calendar"></i> åä¸€æœˆ 13æ—¥, 2019</p><p class="relate-post-content">Beanå’ŒSpringBeanï¼šJavaç±»æˆ–è€…JavaBeanï¼ˆå°±æ˜¯ä¸€ç§ç‰¹æ®Šçš„Javaç±»ï¼‰Springï¼šç”Ÿäº§Beançš„å·¥å‚Spring å¯ä»¥ç”Ÿäº§ç±»çš„å¯¹è±¡ï¼Œä¹Ÿå³å®ä¾‹åŒ–(new ç±»å()); IoC/DI æ§åˆ¶åè½¬/ä¾èµ–æ³¨å…¥IoC : ...</p></div><div class="relate-post-cover"><a href="/ç¼–ç¨‹è¯­è¨€/Java/SpringåŸç†.html" title="SpringåŸç†"><img class="lazy" src="/img/placeholder.jpg" data-src="/img/cart_cover.jpg" alt="SpringåŸç†"></a></div></li></ul></div></div><div class="investment-content-list"><div class="layout-comment"><div>Please check the comment setting in config.yml of hexo-theme-Annie!</div></div></div><div class="investment-content-list"><div class="layout-share"><div class="social-share"></div><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/css/share.min.css"><script async src="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script></div></div></div></div></div></div><script src="/plugin/clipboard/clipboard.js"></script><script>function codePreprocessing(){$("#article-content .highlight").each(function(){$(this).wrap('<div id="post-code"></div>')}),$("#article-content #post-code").each(function(){$(this).prepend('<nav class="copy-nav"><span><i class="code-language"></i></span></nav>')}),$("#article-content .copy-nav").each(function(){var t=$(this).next().attr("class"),e=9<t.length&&null!=t?t.substr(10):"none";$(this).find(".code-language").text(e),$(this).append('<span class="copy-btn"><i class="fa fa-copy" aria-hidden="true"></i></span>')})}function codeCopy(){$("#article-content #post-code").each(function(t){var e="codeCopy-"+t,n=$(this).find(".code"),o=$(this).find(".copy-btn");n.attr("id",e),o.attr("data-clipboard-target-id",e)});var t=new ClipboardJS(".copy-btn",{target:function(t){return document.getElementById(t.getAttribute("data-clipboard-target-id"))}});t.on("success",function(t){var e;t.clearSelection(),console.info("Action:",t.action),console.info("Trigger:",t.trigger),(e=t.trigger).setAttribute("aria-label","Copied!"),e.setAttribute("class","copy-btn copy-status"),setTimeout(function(){e.setAttribute("class","copy-btn")},2e3)}),t.on("error",function(t){console.error("Action:",t.action),console.error("Trigger:",t.trigger)})}$(".layout-post").length&&(codePreprocessing(),codeCopy())</script><link rel="stylesheet" href="/plugin/fancybox/jquery.fancybox.css"><script src="/plugin/fancybox/jquery.fancybox.js"></script><script type="text/javascript">var titleID=$(".article-title a"),imageID=$(".article-content img"),videoID=$(".article-content video"),postTitle=titleID.text()?titleID.text():"No post title!";imageID.each(function(){var t=$(this).attr("src"),a=$(this).attr("alt")?$(this).attr("alt"):"No image description!";$(this).wrap('<a data-fancybox="gallery" data-caption=" ã€Š '+postTitle+" ã€‹ "+a+' "  href=" '+t+' "> </a>')}),videoID.each(function(){var t=$(this).attr("src");$(this).wrap('<a data-fancybox href=" '+t+' "> </a>')}),$("#layout-post").length&&$('[data-fancybox="gallery"]').fancybox({loop:!0,buttons:["zoom","share","slideShow","fullScreen","thumbs","close"],protect:!1})</script></main><footer><div class="social"><ul><li><a href="http://github.com/yindaheng98" target="_blank"><i class="fa fa-github"></i></a></li><li><a href="http://github.com/yindaheng98" target="_blank"><i class="fa fa-weibo"></i></a></li><li><a href="http://github.com/yindaheng98" target="_blank"><i class="fa fa-pinterest"></i></a></li><li><a href="http://github.com/yindaheng98" target="_blank"><i class="fa fa-instagram"></i></a></li><li><a href="http://github.com/yindaheng98" target="_blank"><i class="fa fa-twitter"></i></a></li><li><a href="/atom.xml" target="_blank"><i class="fa fa-rss"></i></a></li></ul></div><div class="copyright"><p>&copy;2017 - 2020, content by Howard Yin. All Rights Reserved.<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv">æœ¬æ–‡æ€»é˜…è¯»é‡<span id="busuanzi_value_page_pv"></span>æ¬¡</span></p><p><a href="http://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a> Theme <a href="https://github.com/Sariay/hexo-theme-Annie" title="Annie" target="_blank" rel="noopener">Annie</a> by Sariay. <a href="javascript:zh_tran('s');" class="zh_click" id="zh_click_s">ç®€ä½“</a> <a href="javascript:zh_tran('t');" class="zh_click" id="zh_click_t">ç¹é«”</a></p></div></footer><script src="/plugin/motto/motto.js"></script><script type="text/javascript">$(".motto").html(getMingYanContent())</script><div id="totop"><a href="javascript:;" name="TOTOP" class="fa fa-arrow-up"></a></div><script src="/plugin/vibrant/vibrant.js"></script><script src="/plugin/chinese/chinese.js"></script><script src="/plugin/imgLazyLoader/yall.min.js"></script><script src="/plugin/imgResize/jquery.resizeimagetoparent.min.js"></script><script src="/plugin/nicescroll/jquery.nicescroll.js"></script><script src="/js/resizediv.js"></script><script src="/js/main.js"></script><script src="https://unpkg.com/mermaid@7.1.2/dist/mermaid.min.js"></script><script>window.mermaid&&mermaid.initialize({theme:"forest"})</script></body></html>